<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Smart Plant Monitor</title>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
  font-family:Segoe UI;
  background:#0f172a;
  color:white;
  text-align:center;
  padding:30px;
}
.card{
  background:#1e293b;
  padding:20px;
  margin:15px auto;
  width:320px;
  border-radius:15px;
  font-size:22px;
}
button{
  padding:15px 25px;
  font-size:20px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin-top:15px;
}
.on{background:#16a34a;color:white;}
.off{background:#dc2626;color:white;}
</style>
</head>

<body>

<h1>ðŸŒ± Smart Plant Monitor</h1>

<div class="card">ðŸŒ¿ Soil : <span id="soil">--</span>%</div>
<div class="card">ðŸŒ¡ Temp : <span id="temp">--</span> Â°C</div>
<div class="card">ðŸš¨ Alarm : <span id="alarm">--</span></div>

<button id="toggleBtn" class="off">ðŸ”‡ à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡</button>

<script>

/* ===== Firebase Config ===== */
const firebaseConfig = {
  apiKey: "AIzaSyC1a-XkNqLQ-fR9K9G3rRq4H3k9SKw9EF0",
  databaseURL: "https://kjszz-1a818-default-rtdb.firebaseio.com/"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ===== READ SENSOR ===== */
db.ref("/sensor/soil").on("value",snap=>{
  document.getElementById("soil").innerText=snap.val();
});

db.ref("/sensor/temperature").on("value",snap=>{
  document.getElementById("temp").innerText=snap.val();
});

db.ref("/sensor/alarm").on("value",snap=>{
  document.getElementById("alarm").innerText=
    snap.val() ? "à¸à¸³à¸¥à¸±à¸‡à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ ðŸ”¥" : "à¸›à¸à¸•à¸´ âœ…";
});

/* ===== BUZZER CONTROL ===== */
let alarmEnable=false;

db.ref("/control/enable").on("value",snap=>{
  alarmEnable=snap.val();
  updateButton();
});

function updateButton(){
  const btn=document.getElementById("toggleBtn");

  if(alarmEnable){
    btn.innerText="ðŸ”Š à¹€à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡";
    btn.className="on";
  }else{
    btn.innerText="ðŸ”‡ à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡";
    btn.className="off";
  }
}

document.getElementById("toggleBtn").onclick=()=>{
  db.ref("/control").update({
    enable:!alarmEnable
  });
};

</script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Plant Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; background: #eceff1; display: flex; justify-content: center; padding: 20px; }
        .box { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 350px; text-align: center; }
        .data-val { font-size: 24px; font-weight: bold; color: #1565c0; }
        .status { margin: 15px 0; padding: 10px; border-radius: 8px; font-weight: bold; }
        .on { background: #ffebee; color: #c62828; }
        .off { background: #e8f5e9; color: #2e7d32; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; }
        .btn-red { background: #f44336; }
        .btn-green { background: #4caf50; }
        .uptime { font-size: 12px; color: #78909c; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="box">
        <h2>üå± Plant Monitor</h2>
        <p>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥: <span class="data-val" id="temp">--</span> ¬∞C</p>
        <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô: <span class="data-val" id="soil">--</span> %</p>
        <div id="statusBox" class="status off">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏Å‡∏ï‡∏¥</div>
        <button id="btn" class="btn-green" onclick="toggle()">‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏ã‡πÄ‡∏£‡∏ô</button>
        <div class="uptime">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <span id="time">--</span></div>
    </div>

    <script>
        const config = { apiKey: "AIzaSyD3V-qYNxPh-jU8A5cEMGo4RH0fJOWa4C4", databaseURL: "https://kjszz-1a818-default-rtdb.firebaseio.com" };
        firebase.initializeApp(config);
        const db = firebase.database();
        let webStatus = false;

        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Real-time
        db.ref('sensor').on('value', (s) => {
            const val = s.val();
            document.getElementById('temp').innerText = val.temperature;
            document.getElementById('soil').innerText = val.soil;
            document.getElementById('time').innerText = val.last_update;
            
            const sBox = document.getElementById('statusBox');
            if(val.alarm) { sBox.innerText = "üö® ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥!"; sBox.className = "status on"; }
            else { sBox.innerText = "‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏Å‡∏ï‡∏¥"; sBox.className = "status off"; }
        });

        // ‡∏î‡∏∂‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
        db.ref('control/alarm').on('value', (s) => {
            webStatus = s.val();
            const b = document.getElementById('btn');
            b.innerText = webStatus ? "‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏ã‡πÄ‡∏£‡∏ô" : "‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏ã‡πÄ‡∏£‡∏ô";
            b.className = webStatus ? "btn-red" : "btn-green";
        });

        function toggle() { db.ref('control/alarm').set(!webStatus); }
    </script>
</body>
</html>
